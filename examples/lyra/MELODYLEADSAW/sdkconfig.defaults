# Increase main task stack size for large Faust DSP objects
CONFIG_ESP_MAIN_TASK_STACK_SIZE=8192

# Enable C++ exceptions for std::bad_alloc handling
CONFIG_COMPILER_CXX_EXCEPTIONS=y
CONFIG_COMPILER_CXX_EXCEPTIONS_EMG_POOL_SIZE=256

# Optimize memory usage
CONFIG_ESP_SYSTEM_EVENT_TASK_STACK_SIZE=2048

# ---- PSRAM / SPIRAM settings (enable only if hardware has PSRAM present) ----
# Minimal safe defaults for ESP-IDF v5.x to initialize external SPI RAM
CONFIG_SPIRAM=y
CONFIG_SPIRAM_BOOT_INIT=y
# Use PSRAM for malloc (enables heap_caps in external memory)
CONFIG_SPIRAM_MALLOC_ALWAYSINTERNAL=0
# Do not automatically place BSS into PSRAM by default
CONFIG_SPIRAM_ALLOW_BSS_SEG_EXTERNAL_MEMORY=n
# Optional cache workaround for certain chips
CONFIG_SPIRAM_CACHE_WORKAROUND=y
